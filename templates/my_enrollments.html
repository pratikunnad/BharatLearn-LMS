{% extends "base.html" %}
{% block content %}

<style>
/* PAGE TITLE */
.page-title {
    text-align: center;
    margin: 30px 0;
    color: var(--primary);
    font-size: 26px;
    font-weight: 700;
}

/* COURSE GRID */
.course-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 26px;
    padding-bottom: 40px;
}

/* COURSE CARD */
.course-card {
    background: #ffffff;
    border-radius: 14px;
    overflow: hidden;
    box-shadow: 0 12px 28px rgba(0,0,0,0.08);
    transition: transform 0.25s, box-shadow 0.25s;
    display: flex;
    flex-direction: column;
}

.course-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 18px 40px rgba(0,0,0,0.12);
}

.course-card img {
    width: 100%;
    height: 170px;
    object-fit: cover;
}

/* CARD BODY */
.card-body {
    padding: 20px;
    flex: 1;
    display: flex;
    flex-direction: column;
}

/* BADGES */
.badge {
    display: inline-block;
    font-size: 12px;
    padding: 5px 12px;
    border-radius: 20px;
    font-weight: 600;
    margin-bottom: 10px;
}

.badge-enrolled {
    background: #22c55e;
    color: #ffffff;
}

.badge-completed {
    background: #2563eb;
    color: #ffffff;
}

/* TEXT */
.course-card h3 {
    font-size: 18px;
    margin-bottom: 8px;
    color: var(--primary);
}

.course-card p {
    font-size: 14px;
    color: #555;
    line-height: 1.5;
    margin-bottom: 12px;
}

.enroll-date {
    font-size: 13px;
    color: #666;
    margin-bottom: 18px;
}

/* ACTIONS */
.card-actions {
    display: grid;
    gap: 10px;
    margin-top: auto;
}

/* BUTTONS */
.visit-btn {
    text-align: center;
    padding: 10px;
    border-radius: 8px;
    background: linear-gradient(135deg, #2563eb, #0a3d62);
    color: #ffffff;
    font-size: 13px;
    font-weight: 600;
    text-decoration: none;
}

.btn-complete {
    padding: 9px;
    border-radius: 8px;
    border: none;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    background: #22c55e;
    color: white;
}

.btn-complete:disabled {
    background: #94a3b8;
    cursor: not-allowed;
}

.btn-danger {
    background: #dc2626;
    color: white;
    border: none;
    padding: 9px;
    border-radius: 8px;
    font-size: 13px;
    cursor: pointer;
}

/* EMPTY */
.empty {
    text-align: center;
    font-size: 16px;
    margin-top: 40px;
    color: #64748b;
}

/* BACK BUTTON */
.back-btn-wrapper {
    margin-top: 40px;
    text-align: center;
}

.back-btn {
    padding: 12px 28px;
    background: linear-gradient(135deg, #0a3d62, #2563eb);
    color: white;
    border-radius: 30px;
    text-decoration: none;
    font-weight: 600;
}

.back-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.25);
}

/* DARK MODE */
body.dark .course-card {
    background: #020617;
}

body.dark .course-card p,
body.dark .enroll-date {
    color: #cbd5f5;
}

body.dark .course-card h3 {
    color: #60a5fa;
}

</style>

<h2 class="page-title">My Enrolled Courses</h2>

{% if courses %}
<div class="course-grid">
{% for course in courses %}
<div class="course-card">

    {% if course.image_url %}
        {% if course.image_url.startswith('http') %}
            <img src="{{ course.image_url }}">
        {% else %}
            <img src="{{ url_for('static', filename='images/' ~ course.image_url) }}">
        {% endif %}
    {% else %}
        <img src="{{ url_for('static', filename='images/default-course.png') }}">
    {% endif %}

    <div class="card-body">

        {% if course.completed %}
            <span class="badge badge-completed">‚úî Completed</span>
        {% else %}
            <span class="badge badge-enrolled">Enrolled</span>
        {% endif %}

        <h3>{{ course.title }}</h3>
        <p>{{ course.description }}</p>

        <div class="enroll-date">
            Enrolled on {{ course.enrolled_at.strftime("%d %b %Y") }}
        </div>

        <div class="card-actions">

            <a href="/learner/visit-course/{{ course.id }}" target="_blank" class="visit-btn">
                ‚ñ∂ Visit Course
            </a>

            <form method="POST"
                action="{{ url_for('mark_completed', enrollment_id=course.enrollment_id) }}">
                <button class="btn-complete"
                        {% if course.completed %}disabled{% endif %}>
                    ‚úì Mark as Completed
                </button>
            </form>


            <form method="POST"
                  action="{{ url_for('unenroll', course_id=course.id) }}"
                  onsubmit="return confirm('Unenroll from this course?');">
                <button class="btn-danger">Unenroll</button>
            </form>

        </div>
    </div>
</div>
{% endfor %}
</div>
{% else %}
<p class="empty">You have not enrolled in any courses yet üòï</p>
{% endif %}

<div class="back-btn-wrapper">
    <a href="/learner/dashboard" class="back-btn">‚Üê Back to Dashboard</a>
</div>

{% endblock %}